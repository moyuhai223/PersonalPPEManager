# 个人劳保用品管理系统 (Personal Protective Equipment Management System)

## 简介 (Description)

本项目是一款专为Windows桌面环境开发的个人劳保用品（PPE）管理应用程序。其主要目的是帮助用户或小型团队有效记录、跟踪和管理员工的个人防护装备信息。系统设计时特别考虑了在 Windows 7 (32位) 等环境下的稳定运行，并采用轻量级的 SQLite 本地数据库进行数据存储，无需外部数据库服务器，方便独立部署和使用。

该系统能够管理员工基本信息、各类劳保用品（如洁净服、帽子、防护鞋等）的发放、替换以及相关的记录查询。此外，还提供了数据导入、备份、恢复及操作日志查看等实用工具，以提升数据管理效率和安全性。

## 主要功能 (Key Features)

* **员工信息管理 (Employee Management):**
    * 支持添加、编辑、删除员工的完整信息。
    * 记录字段包括：工号（唯一）、姓名、入职时间、工序、在职状态、一楼衣柜、一楼鞋柜、二楼衣柜、二楼鞋柜以及新增的**备注**字段。
    * 提供列表展示和表单编辑功能。

* **劳保用品发放管理 (PPE Issuance Management):**
    * 记录向指定员工发放各类劳保用品的详细信息。
    * 支持洁净服（最多3套，超出上限时提供替换旧有记录的逻辑）、帽子（最多3套）、白色劳保鞋、白色帆布鞋等。
    * 可记录用品的特定编码、尺码、发放日期（精确到日）、新旧状态（针对鞋类）。
    * 员工信息加载后，其工号、姓名、工序会在界面上单行显示以便确认。

* **综合查询 (Comprehensive Query):**
    * 支持按员工工号、员工姓名或**洁净服编码**进行员工及其劳保用品信息的查询。
    * 清晰展示选中员工的详细个人信息（包括所有储物柜信息，不含在职状态，布局已优化为更表格化的视图）。
    * 列表展示选中员工当前所有**有效**的劳保用品记录。
    * 支持**双击**劳保用品列表中的某条记录，弹出对话框以**编辑**该条劳保用品的详细信息（如编码、尺码、发放日期、新旧状态、是否有效、备注等）。

* **数据工具 (Data Utilities):**
    * **批量导入员工CSV:** 允许用户从特定格式的CSV文件批量导入员工基本信息（包括备注）。CSV文件需使用UTF-8编码。
    * **数据库备份:** 提供将当前整个应用程序数据库 (`ppe_database.sqlite`) 完整备份到用户指定位置的功能。
    * **数据库恢复:** 允许用户从之前创建的 `.sqlite` 备份文件中恢复数据。此操作会覆盖当前所有数据，并有明确的警告和用户确认流程，恢复后建议重启应用。

* **操作日志 (Operation Log Viewing):**
    * 系统自动记录大部分关键操作（如员工增删改、劳保用品发放与修改、数据导入、备份、恢复等）。
    * 提供界面查看这些操作日志，支持按日期范围和操作类型（模糊匹配）进行筛选。

* **其他已实现特性:**
    * 应用程序具有自定义图标。
    * CSV导入导出功能明确指定使用UTF-8编码，以解决在Windows 7等环境下可能出现的中文乱码问题。

## 技术栈 (Technology Stack)

* **编程语言 (Language):** C#
* **UI 框架 (UI Framework):** WPF (Windows Presentation Foundation)
* **设计模式 (Design Pattern):** MVVM (Model-View-ViewModel)
* **数据库 (Database):** SQLite (本地文件数据库 `ppe_database.sqlite`)
* **目标 .NET 版本 (Target .NET Version):** .NET Framework 4.6.2
* **开发环境 (IDE):** Visual Studio

## 使用说明 (Usage Instructions - Brief)

1.  **启动应用:** 直接运行项目生成目录（如 `bin/Debug` 或 `bin/Release`）下的 `PersonalPPEManager.exe` 文件。首次运行时，若数据库文件不存在，系统会自动在程序目录下创建 `ppe_database.sqlite` 文件及所需数据表。
2.  **界面导航:** 主窗口左侧为导航栏，点击按钮可切换到不同的功能模块。
3.  **员工管理:**
    * 点击“新增员工”按钮清空表单，然后填写新员工信息，点击“保存更改”进行添加。
    * 从列表中选择员工，其信息会自动加载到表单中，修改后点击“保存更改”进行更新。
    * 选中员工后可点击“删除选中”按钮进行删除（会一并删除关联的劳保用品记录）。
4.  **劳保发放:**
    * 输入员工工号并点击“加载员工”。
    * 在下方各用品区域勾选并填写要发放的物品信息。
    * 若发放洁净服超出数量上限（当前为3套），且为1换1场景，界面会提示选择一件旧洁净服进行替换，选择后再点击“保存发放记录”即可完成替换和新发放。
5.  **综合查询:**
    * 选择查询类型（按工号、姓名或洁净服编码），输入搜索内容，点击“查询”。
    * 如果按姓名搜索结果多于一个，会在下方列表显示，点击列表项可查看详情。
    * 员工详细信息和其持有的有效劳保用品会显示在下方。
    * **双击**“当前持有劳保用品”列表中的某条记录，可以弹出对话框修改该条记录的详细信息。
6.  **数据工具:**
    * **CSV导入:** 准备好UTF-8编码的员工信息CSV文件（表头：`EmployeeID,Name,EntryDate,Process,Status,LockerClothes1,LockerShoes1,LockerClothes2,LockerShoes2,Remarks`），点击“浏览...”选择文件，然后点击“开始导入”。注意查看导入状态反馈。
    * **数据库备份:** 点击按钮，选择一个安全的位置保存当前数据库的备份文件。
    * **数据库恢复:** **请谨慎操作！** 此操作会覆盖当前数据。点击按钮，选择之前备份的 `.sqlite` 文件进行恢复。恢复完成后，强烈建议重启应用程序。
7.  **操作日志:**
    * 直接进入界面即可看到最近的操作记录。
    * 可使用顶部的日期和操作类型筛选器来查找特定日志。

## 注意事项 (Important Notes)

* **Windows 7 兼容性:** 本项目使用 .NET Framework 4.6.2 开发，旨在兼容 Windows 7 及以上操作系统。
* **数据库文件:** `ppe_database.sqlite` 文件包含了所有应用程序数据，非常重要。建议定期使用系统内置的“数据库备份”功能进行数据备份。
* **CSV文件编码:** 进行CSV导入时，请确保你的CSV文件是 **UTF-8** 编码，以避免中文字符乱码。系统导出的CSV文件也将是UTF-8编码。

---

这份 `README.md` 应该能很好地概括我们目前完成的项目。你可以根据需要自由修改和扩展。
如果还有其他问题或新的需求，随时告诉我！