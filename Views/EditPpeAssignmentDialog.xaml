<Window x:Class="PersonalPPEManager.Views.EditPpeAssignmentDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:viewmodels="clr-namespace:PersonalPPEManager.ViewModels" 
        xmlns:converters="clr-namespace:PersonalPPEManager.Converters"
        mc:Ignorable="d"
        Title="编辑劳保用品记录" 
        SizeToContent="WidthAndHeight" 
        WindowStartupLocation="CenterOwner"
        WindowStyle="ToolWindow" 
        ResizeMode="NoResize" 
        ShowInTaskbar="False" 
        MinWidth="400" MaxWidth="600"
        DataContextChanged="EditPpeAssignmentDialog_DataContextChanged">

    <Window.Resources>
        <ResourceDictionary>
            <converters:ShoeTypeToVisibilityConverter x:Key="ShoeTypeToVisibilityConverter"/>
        </ResourceDictionary>
    </Window.Resources>

    <Border Padding="20">
        <StackPanel>
            <TextBlock Text="编辑以下劳保用品发放记录：" Margin="0,0,0,15" FontSize="14" FontWeight="Bold"/>

            <Grid DataContext="{Binding CurrentPpeAssignment}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" MinWidth="90"/>
                    <ColumnDefinition Width="*" MinWidth="250"/>
                </Grid.ColumnDefinitions>

                <Label Grid.Row="0" Grid.Column="0" Content="用品类型:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding PPE_Type, Mode=OneWay}" IsReadOnly="True" Background="#f0f0f0" Margin="0,3,0,3" Padding="3"/>

                <Label Grid.Row="1" Grid.Column="0" Content="物品编号:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding ItemSpecificCode, UpdateSourceTrigger=PropertyChanged}" Margin="0,3,0,3" Padding="3" MaxLength="50"/>

                <Label Grid.Row="2" Grid.Column="0" Content="尺码:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding Size, UpdateSourceTrigger=PropertyChanged}" Margin="0,3,0,3" Padding="3" MaxLength="20"/>

                <Label Grid.Row="3" Grid.Column="0" Content="发放日期:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <DatePicker Grid.Row="3" Grid.Column="1" 
                            SelectedDate="{Binding IssueDate, UpdateSourceTrigger=PropertyChanged, StringFormat=yyyy-MM-dd, TargetNullValue=''}" 
                            Margin="0,3,0,3"/>

                <Label Grid.Row="4" Grid.Column="0" Content="新旧状态:" VerticalAlignment="Center" Margin="0,0,5,0"
                       Visibility="{Binding PPE_Type, Converter={StaticResource ShoeTypeToVisibilityConverter}}"/>
                <ComboBox Grid.Row="4" Grid.Column="1" 
                          ItemsSource="{Binding DataContext.ShoeConditions, RelativeSource={RelativeSource AncestorType=Window}}" 
                          SelectedItem="{Binding Condition, UpdateSourceTrigger=PropertyChanged}" Margin="0,3,0,3"
                          Visibility="{Binding PPE_Type, Converter={StaticResource ShoeTypeToVisibilityConverter}}"/>

                <Label Grid.Row="5" Grid.Column="0" Content="是否有效:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <CheckBox Grid.Row="5" Grid.Column="1" IsChecked="{Binding IsActive, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" Margin="0,5,0,5"/>

                <Label Grid.Row="6" Grid.Column="0" Content="备注:" VerticalAlignment="Top" Margin="0,5,5,0"/>
                <TextBox Grid.Row="6" Grid.Column="1" Text="{Binding Remarks, UpdateSourceTrigger=PropertyChanged}" Margin="0,3,0,3" MinHeight="60" MaxHeight="120" TextWrapping="Wrap" AcceptsReturn="True" VerticalScrollBarVisibility="Auto" Padding="3"/>
            </Grid>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,25,0,0">
                <Button Content="保存更改" Command="{Binding SaveCommand}" IsDefault="True" MinWidth="90" Margin="0,0,10,0" Padding="10,5"/>
                <Button Content="取消" Command="{Binding CancelCommand}" IsCancel="True" MinWidth="90" Padding="10,5"/>
            </StackPanel>
        </StackPanel>
    </Border>
</Window>