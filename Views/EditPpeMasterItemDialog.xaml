<Window x:Class="PersonalPPEManager.Views.EditPpeMasterItemDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:viewmodels="clr-namespace:PersonalPPEManager.ViewModels"
        mc:Ignorable="d"
        Title="{Binding WindowTitle}" SizeToContent="WidthAndHeight" WindowStartupLocation="CenterOwner"
        WindowStyle="ToolWindow" ResizeMode="NoResize" ShowInTaskbar="False" 
        MinWidth="450" MaxWidth="600"
        DataContextChanged="EditPpeMasterItemDialog_DataContextChanged">
    <Border Padding="20">
        <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="700">
            <StackPanel>
                <TextBlock Text="{Binding WindowTitle}" Margin="0,0,0,15" FontSize="14" FontWeight="Bold"/>

                <Grid DataContext="{Binding CurrentMasterItem}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" MinWidth="120"/>
                        <ColumnDefinition Width="*" MinWidth="250"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Row="0" Grid.Column="0" Content="用品主代码*:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding ItemMasterCode, UpdateSourceTrigger=PropertyChanged}" Margin="0,3,0,3" Padding="3" MaxLength="50"/>

                    <Label Grid.Row="1" Grid.Column="0" Content="用品名称*:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding ItemName, UpdateSourceTrigger=PropertyChanged}" Margin="0,3,0,3" Padding="3" MaxLength="100"/>

                    <Label Grid.Row="2" Grid.Column="0" Content="所属类别*:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <ComboBox Grid.Row="2" Grid.Column="1" 
                              ItemsSource="{Binding DataContext.AvailableCategories, RelativeSource={RelativeSource AncestorType=Window}}"
                              SelectedValue="{Binding CategoryID_FK, UpdateSourceTrigger=PropertyChanged}"
                              DisplayMemberPath="CategoryName"
                              SelectedValuePath="CategoryID"
                              Margin="0,3,0,3"/>

                    <Label Grid.Row="3" Grid.Column="0" Content="尺码/规格:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding Size, UpdateSourceTrigger=PropertyChanged}" Margin="0,3,0,3" Padding="3" MaxLength="50"/>

                    <Label Grid.Row="4" Grid.Column="0" Content="计量单位:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Grid.Row="4" Grid.Column="1" Text="{Binding UnitOfMeasure, UpdateSourceTrigger=PropertyChanged}" Margin="0,3,0,3" Padding="3" MaxLength="20"/>

                    <Label Grid.Row="5" Grid.Column="0" Content="预计寿命(天):" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Grid.Row="5" Grid.Column="1" Text="{Binding ExpectedLifespanDays, UpdateSourceTrigger=PropertyChanged, TargetNullValue=''}" Margin="0,3,0,3" Padding="3" MaxLength="5"/>
                    <Label Grid.Row="6" Grid.Column="0" Content="当前库存:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Grid.Row="6" Grid.Column="1" Text="{Binding CurrentStock, UpdateSourceTrigger=PropertyChanged}" Margin="0,3,0,3" Padding="3" MaxLength="7"/>

                    <Label Grid.Row="7" Grid.Column="0" Content="低库存阈值:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Grid.Row="7" Grid.Column="1" Text="{Binding LowStockThreshold, UpdateSourceTrigger=PropertyChanged}" Margin="0,3,0,3" Padding="3" MaxLength="7"/>

                    <Label Grid.Row="8" Grid.Column="0" Content="默认备注:" VerticalAlignment="Top" Margin="0,5,5,0"/>
                    <TextBox Grid.Row="8" Grid.Column="1" Text="{Binding DefaultRemarks, UpdateSourceTrigger=PropertyChanged}" Margin="0,3,0,3" MinHeight="60" MaxHeight="100" TextWrapping="Wrap" AcceptsReturn="True" VerticalScrollBarVisibility="Auto" Padding="3"/>
                </Grid>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,25,0,0">
                    <Button Content="保存" Command="{Binding SaveCommand}" IsDefault="True" MinWidth="80" Margin="0,0,10,0" Padding="10,5"/>
                    <Button Content="取消" Command="{Binding CancelCommand}" IsCancel="True" MinWidth="80" Padding="10,5"/>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Border>
</Window>