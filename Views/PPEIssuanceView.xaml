<UserControl x:Class="PersonalPPEManager.Views.PPEIssuanceView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:viewmodels="clr-namespace:PersonalPPEManager.ViewModels"
             xmlns:converters="clr-namespace:PersonalPPEManager.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="750" d:DesignWidth="1100"  
             Background="White">

    <UserControl.Resources>
        <ResourceDictionary>
            <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
            <converters:NullToVisibilityCollapsedConverter x:Key="NullToVisibilityCollapsedConverter"/>
            <converters:NullToBooleanFalseConverter x:Key="NullToBooleanFalseConverter"/>
        </ResourceDictionary>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
        <Grid Margin="15">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0" Text="劳保用品发放" FontSize="20" FontWeight="Bold" Margin="0,0,0,15"/>

            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                <Label Content="员工工号:" VerticalAlignment="Center"/>
                <TextBox Text="{Binding SearchEmployeeID, UpdateSourceTrigger=PropertyChanged}" Width="150" Margin="5,0" VerticalAlignment="Center" MaxLength="50" Padding="3"/>
                <Button Content="加载员工" Command="{Binding LoadEmployeeCommand}" Padding="10,5" Margin="5,0"/>
            </StackPanel>

            <Border Grid.Row="2" Margin="0,0,0,15" Padding="10" BorderBrush="LightGray" BorderThickness="1" CornerRadius="3"
                    Visibility="{Binding IsEmployeeLoaded, Converter={StaticResource BooleanToVisibilityConverter}}">
                <StackPanel>
                    <TextBlock Text="当前员工信息:" FontWeight="Bold" Margin="0,0,0,5"/>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Margin="0,0,20,0"><Run Text="工号: " FontWeight="SemiBold"/><Run Text="{Binding LoadedEmployee.EmployeeID, Mode=OneWay}"/></TextBlock>
                        <TextBlock Margin="0,0,20,0"><Run Text="姓名: " FontWeight="SemiBold"/><Run Text="{Binding LoadedEmployee.Name, Mode=OneWay}"/></TextBlock>
                        <TextBlock><Run Text="工序: " FontWeight="SemiBold"/><Run Text="{Binding LoadedEmployee.Process, Mode=OneWay}"/></TextBlock>
                    </StackPanel>
                </StackPanel>
            </Border>

            <Grid Grid.Row="3">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="10"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Vertical">
                    <GroupBox Header="洁净服发放 (选择规格后填写下方具体编号)" Margin="0,0,0,10" Padding="10">
                        <StackPanel>
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="2*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Label Grid.Row="0" Grid.Column="0" Content="选择类别:" VerticalAlignment="Center"/>
                                <ComboBox Grid.Row="0" Grid.Column="1" Margin="5,3,10,3" VerticalAlignment="Center" MinWidth="120" Padding="3" ItemsSource="{Binding AllPpeCategories}" SelectedItem="{Binding SelectedSuitCategory, Mode=TwoWay}" DisplayMemberPath="CategoryName"/>
                                <Label Grid.Row="0" Grid.Column="2" Content="选择规格:" VerticalAlignment="Center"/>
                                <ComboBox Grid.Row="0" Grid.Column="3" Margin="5,3,0,3" VerticalAlignment="Center" MinWidth="180" Padding="3" ItemsSource="{Binding AvailableSuitMasterItems}" SelectedItem="{Binding SelectedSuitMasterItem, Mode=TwoWay}" DisplayMemberPath="DisplayName" IsEnabled="{Binding SelectedSuitCategory, Converter={StaticResource NullToBooleanFalseConverter}}"/>
                                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" Orientation="Horizontal" Margin="0,5,0,0" Visibility="{Binding SelectedSuitMasterItem, Converter={StaticResource NullToVisibilityCollapsedConverter}}">
                                    <TextBlock Margin="5,0,15,0" FontWeight="SemiBold"><Run Text="尺码: "/><Run Text="{Binding SelectedSuitMasterItem.Size, FallbackValue='N/A'}"/></TextBlock>
                                    <TextBlock FontWeight="SemiBold"><Run Text="库存: "/><Run Text="{Binding SelectedSuitMasterItem.CurrentStock, FallbackValue='N/A'}"/><Run Text=" "/><Run Text="{Binding SelectedSuitMasterItem.UnitOfMeasure, FallbackValue='套'}"/></TextBlock>
                                </StackPanel>
                                <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4" Text="为每件洁净服输入唯一编号/序列号：" FontSize="10" FontStyle="Italic" Margin="0,8,0,5" Visibility="{Binding SelectedSuitMasterItem, Converter={StaticResource NullToVisibilityCollapsedConverter}}"/>
                            </Grid>
                            <Border Padding="5" Margin="0,0,0,5" BorderBrush="AliceBlue" BorderThickness="1" IsEnabled="{Binding SelectedSuitMasterItem, Converter={StaticResource NullToBooleanFalseConverter}}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox Grid.Column="0" IsChecked="{Binding Suit1_IsBeingIssued}" VerticalAlignment="Center" Content="发放洁净服1" Margin="0,0,10,0"/>
                                    <Label Grid.Column="1" Content="物品编号*:" IsEnabled="{Binding Suit1_IsBeingIssued}" VerticalAlignment="Center" />
                                    <TextBox Grid.Column="2" Text="{Binding Suit1_ItemCode, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding Suit1_IsBeingIssued}" MinWidth="100" Margin="0,3,10,3" VerticalAlignment="Center" MaxLength="50" Padding="3"/>
                                    <Label Grid.Column="3" Content="发放日期*:" IsEnabled="{Binding Suit1_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <DatePicker Grid.Column="4" SelectedDate="{Binding Suit1_IssueDate, UpdateSourceTrigger=PropertyChanged, StringFormat=yyyy-MM-dd}" IsEnabled="{Binding Suit1_IsBeingIssued}" MinWidth="100" VerticalAlignment="Center" Padding="3"/>
                                </Grid>
                            </Border>
                            <Border Padding="5" Margin="0,0,0,5" BorderBrush="AliceBlue" BorderThickness="1" IsEnabled="{Binding SelectedSuitMasterItem, Converter={StaticResource NullToBooleanFalseConverter}}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox Grid.Column="0" IsChecked="{Binding Suit2_IsBeingIssued}" VerticalAlignment="Center" Content="发放洁净服2" Margin="0,0,10,0"/>
                                    <Label Grid.Column="1" Content="物品编号*:" IsEnabled="{Binding Suit2_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="2" Text="{Binding Suit2_ItemCode, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding Suit2_IsBeingIssued}" MinWidth="100" Margin="0,3,10,3" VerticalAlignment="Center" MaxLength="50" Padding="3"/>
                                    <Label Grid.Column="3" Content="发放日期*:" IsEnabled="{Binding Suit2_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <DatePicker Grid.Column="4" SelectedDate="{Binding Suit2_IssueDate, UpdateSourceTrigger=PropertyChanged, StringFormat=yyyy-MM-dd}" IsEnabled="{Binding Suit2_IsBeingIssued}" MinWidth="100" VerticalAlignment="Center" Padding="3"/>
                                </Grid>
                            </Border>
                            <Border Padding="5" Margin="0,0,0,5" BorderBrush="AliceBlue" BorderThickness="1" IsEnabled="{Binding SelectedSuitMasterItem, Converter={StaticResource NullToBooleanFalseConverter}}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox Grid.Column="0" IsChecked="{Binding Suit3_IsBeingIssued}" VerticalAlignment="Center" Content="发放洁净服3" Margin="0,0,10,0"/>
                                    <Label Grid.Column="1" Content="物品编号*:" IsEnabled="{Binding Suit3_IsBeingIssued}" VerticalAlignment="Center" />
                                    <TextBox Grid.Column="2" Text="{Binding Suit3_ItemCode, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding Suit3_IsBeingIssued}" MinWidth="100" Margin="0,3,10,3" VerticalAlignment="Center" MaxLength="50" Padding="3"/>
                                    <Label Grid.Column="3" Content="发放日期*:" IsEnabled="{Binding Suit3_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <DatePicker Grid.Column="4" SelectedDate="{Binding Suit3_IssueDate, UpdateSourceTrigger=PropertyChanged, StringFormat=yyyy-MM-dd}" IsEnabled="{Binding Suit3_IsBeingIssued}" MinWidth="100" VerticalAlignment="Center" Padding="3"/>
                                </Grid>
                            </Border>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="替换旧洁净服" Margin="0,5,0,10" Padding="10"
                              Visibility="{Binding IsSuitReplacementModeActive, Converter={StaticResource BooleanToVisibilityConverter}}"
                              BorderBrush="OrangeRed" BorderThickness="1.5">
                        <StackPanel>
                            <TextBlock Text="{Binding ReplacementInstructionMessage}" Foreground="DarkRed" FontWeight="SemiBold" TextWrapping="Wrap" Margin="0,0,0,10"/>
                            <TextBlock Text="请从下方选择一件要替换的旧洁净服:" Margin="0,0,0,5"/>
                            <ComboBox ItemsSource="{Binding ActiveSuitsForReplacement}" SelectedItem="{Binding SelectedSuitForReplacement, Mode=TwoWay}" MinWidth="300" HorizontalAlignment="Stretch" MaxWidth="450" Padding="3">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="编码: "/>
                                            <TextBlock Text="{Binding ItemSpecificCode}" FontWeight="Bold" Margin="0,0,10,0"/>
                                            <TextBlock Text="尺码: "/>
                                            <TextBlock Text="{Binding Size}" Margin="0,0,10,0"/>
                                            <TextBlock Text="发放日期: "/>
                                            <TextBlock Text="{Binding IssueDate, StringFormat=yyyy-MM-dd}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            <TextBlock Text="选择后，请再次点击下方的“保存发放记录”按钮以确认替换并发放新洁净服。" FontSize="10" FontStyle="Italic" Margin="0,10,0,0" TextWrapping="Wrap"/>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="白色劳保鞋发放" Margin="0,0,0,10" Padding="10">
                        <StackPanel>
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="2*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Label Grid.Row="0" Grid.Column="0" Content="选择类别:"/>
                                <ComboBox Grid.Row="0" Grid.Column="1" Margin="5,3,10,3" MinWidth="120" Padding="3" ItemsSource="{Binding AllPpeCategories}" SelectedItem="{Binding SelectedSafetyShoeCategory, Mode=TwoWay}" DisplayMemberPath="CategoryName"/>
                                <Label Grid.Row="0" Grid.Column="2" Content="选择规格:"/>
                                <ComboBox Grid.Row="0" Grid.Column="3" Margin="5,3,0,3" MinWidth="180" Padding="3" ItemsSource="{Binding AvailableSafetyShoeMasterItems}" SelectedItem="{Binding SelectedSafetyShoeMasterItem, Mode=TwoWay}" DisplayMemberPath="DisplayName" IsEnabled="{Binding SelectedSafetyShoeCategory, Converter={StaticResource NullToBooleanFalseConverter}}"/>
                                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" Orientation="Horizontal" Margin="0,5,0,0" Visibility="{Binding SelectedSafetyShoeMasterItem, Converter={StaticResource NullToVisibilityCollapsedConverter}}">
                                    <TextBlock Margin="5,0,15,0" FontWeight="SemiBold"><Run Text="尺码: "/><Run Text="{Binding SafetyShoes_SizeVM, FallbackValue='N/A'}"/></TextBlock>
                                    <TextBlock FontWeight="SemiBold"><Run Text="库存: "/><Run Text="{Binding SelectedSafetyShoeMasterItem.CurrentStock, FallbackValue='N/A'}"/><Run Text=" "/><Run Text="{Binding SelectedSafetyShoeMasterItem.UnitOfMeasure, FallbackValue='双'}"/></TextBlock>
                                </StackPanel>
                            </Grid>
                            <Border Padding="5" BorderBrush="AliceBlue" BorderThickness="1" IsEnabled="{Binding SelectedSafetyShoeMasterItem, Converter={StaticResource NullToBooleanFalseConverter}}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox Grid.Column="0" IsChecked="{Binding SafetyShoes_IsBeingIssued}" VerticalAlignment="Center" Content="发放此规格" Margin="0,0,10,0"/>
                                    <Label Grid.Column="1" Content="新旧*:" IsEnabled="{Binding SafetyShoes_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="2" ItemsSource="{Binding ShoeConditions}" SelectedItem="{Binding SafetyShoes_Condition, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding SafetyShoes_IsBeingIssued}" MinWidth="70" Margin="0,3,10,3" VerticalAlignment="Center" Padding="3"/>
                                    <Label Grid.Column="3" Content="发放日期*:" IsEnabled="{Binding SafetyShoes_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <DatePicker Grid.Column="4" SelectedDate="{Binding SafetyShoes_IssueDate, UpdateSourceTrigger=PropertyChanged, StringFormat=yyyy-MM-dd}" IsEnabled="{Binding SafetyShoes_IsBeingIssued}" MinWidth="100" VerticalAlignment="Center" Padding="3"/>
                                </Grid>
                            </Border>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Vertical">
                    <GroupBox Header="帽子发放 (选择规格后填写下方具体编号)" Margin="0,0,0,10" Padding="10">
                        <StackPanel>
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="2*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Label Grid.Row="0" Grid.Column="0" Content="选择类别:"/>
                                <ComboBox Grid.Row="0" Grid.Column="1" Margin="5,3,10,3" MinWidth="120" Padding="3" ItemsSource="{Binding AllPpeCategories}" SelectedItem="{Binding SelectedHatCategory, Mode=TwoWay}" DisplayMemberPath="CategoryName"/>
                                <Label Grid.Row="0" Grid.Column="2" Content="选择规格:"/>
                                <ComboBox Grid.Row="0" Grid.Column="3" Margin="5,3,0,3" MinWidth="180" Padding="3" ItemsSource="{Binding AvailableHatMasterItems}" SelectedItem="{Binding SelectedHatMasterItem, Mode=TwoWay}" DisplayMemberPath="DisplayName" IsEnabled="{Binding SelectedHatCategory, Converter={StaticResource NullToBooleanFalseConverter}}"/>
                                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" Orientation="Horizontal" Margin="0,5,0,0" Visibility="{Binding SelectedHatMasterItem, Converter={StaticResource NullToVisibilityCollapsedConverter}}">
                                    <TextBlock Margin="5,0,15,0" FontWeight="SemiBold"><Run Text="尺码: "/><Run Text="{Binding SelectedHatMasterItem.Size, FallbackValue='均码'}"/></TextBlock>
                                    <TextBlock FontWeight="SemiBold"><Run Text="库存: "/><Run Text="{Binding SelectedHatMasterItem.CurrentStock, FallbackValue='N/A'}"/><Run Text=" "/><Run Text="{Binding SelectedHatMasterItem.UnitOfMeasure, FallbackValue='顶'}"/></TextBlock>
                                </StackPanel>
                                <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4" Text="为每顶帽子输入唯一编号/序列号：" FontSize="10" FontStyle="Italic" Margin="0,8,0,5" Visibility="{Binding SelectedHatMasterItem, Converter={StaticResource NullToVisibilityCollapsedConverter}}"/>
                            </Grid>
                            <Border Padding="5" Margin="0,0,0,5" BorderBrush="AliceBlue" BorderThickness="1" IsEnabled="{Binding SelectedHatMasterItem, Converter={StaticResource NullToBooleanFalseConverter}}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox Grid.Column="0" IsChecked="{Binding Hat1_IsBeingIssued}" VerticalAlignment="Center" Content="发放帽子1" Margin="0,0,10,0"/>
                                    <Label Grid.Column="1" Content="物品编号*:" IsEnabled="{Binding Hat1_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="2" Text="{Binding Hat1_ItemCode, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding Hat1_IsBeingIssued}" MinWidth="100" Margin="0,3,10,3" VerticalAlignment="Center" MaxLength="50" Padding="3"/>
                                    <Label Grid.Column="3" Content="发放日期*:" IsEnabled="{Binding Hat1_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <DatePicker Grid.Column="4" SelectedDate="{Binding Hat1_IssueDate, UpdateSourceTrigger=PropertyChanged, StringFormat=yyyy-MM-dd}" IsEnabled="{Binding Hat1_IsBeingIssued}" MinWidth="100" VerticalAlignment="Center" Padding="3"/>
                                </Grid>
                            </Border>
                            <Border Padding="5" Margin="0,0,0,5" BorderBrush="AliceBlue" BorderThickness="1" IsEnabled="{Binding SelectedHatMasterItem, Converter={StaticResource NullToBooleanFalseConverter}}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox Grid.Column="0" IsChecked="{Binding Hat2_IsBeingIssued}" VerticalAlignment="Center" Content="发放帽子2" Margin="0,0,10,0"/>
                                    <Label Grid.Column="1" Content="物品编号*:" IsEnabled="{Binding Hat2_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="2" Text="{Binding Hat2_ItemCode, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding Hat2_IsBeingIssued}" MinWidth="100" Margin="0,3,10,3" VerticalAlignment="Center" MaxLength="50" Padding="3"/>
                                    <Label Grid.Column="3" Content="发放日期*:" IsEnabled="{Binding Hat2_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <DatePicker Grid.Column="4" SelectedDate="{Binding Hat2_IssueDate, UpdateSourceTrigger=PropertyChanged, StringFormat=yyyy-MM-dd}" IsEnabled="{Binding Hat2_IsBeingIssued}" MinWidth="100" VerticalAlignment="Center" Padding="3"/>
                                </Grid>
                            </Border>
                            <Border Padding="5" Margin="0,0,0,5" BorderBrush="AliceBlue" BorderThickness="1" IsEnabled="{Binding SelectedHatMasterItem, Converter={StaticResource NullToBooleanFalseConverter}}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox Grid.Column="0" IsChecked="{Binding Hat3_IsBeingIssued}" VerticalAlignment="Center" Content="发放帽子3" Margin="0,0,10,0"/>
                                    <Label Grid.Column="1" Content="物品编号*:" IsEnabled="{Binding Hat3_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <TextBox Grid.Column="2" Text="{Binding Hat3_ItemCode, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding Hat3_IsBeingIssued}" MinWidth="100" Margin="0,3,10,3" VerticalAlignment="Center" MaxLength="50" Padding="3"/>
                                    <Label Grid.Column="3" Content="发放日期*:" IsEnabled="{Binding Hat3_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <DatePicker Grid.Column="4" SelectedDate="{Binding Hat3_IssueDate, UpdateSourceTrigger=PropertyChanged, StringFormat=yyyy-MM-dd}" IsEnabled="{Binding Hat3_IsBeingIssued}" MinWidth="100" VerticalAlignment="Center" Padding="3"/>
                                </Grid>
                            </Border>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="白色帆布鞋发放" Margin="0,0,0,10" Padding="10">
                        <StackPanel>
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="2*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Label Grid.Row="0" Grid.Column="0" Content="选择类别:"/>
                                <ComboBox Grid.Row="0" Grid.Column="1" Margin="5,3,10,3" MinWidth="120" Padding="3" ItemsSource="{Binding AllPpeCategories}" SelectedItem="{Binding SelectedCanvasShoeCategory, Mode=TwoWay}" DisplayMemberPath="CategoryName"/>
                                <Label Grid.Row="0" Grid.Column="2" Content="选择规格:"/>
                                <ComboBox Grid.Row="0" Grid.Column="3" Margin="5,3,0,3" MinWidth="180" Padding="3" ItemsSource="{Binding AvailableCanvasShoeMasterItems}" SelectedItem="{Binding SelectedCanvasShoeMasterItem, Mode=TwoWay}" DisplayMemberPath="DisplayName" IsEnabled="{Binding SelectedCanvasShoeCategory, Converter={StaticResource NullToBooleanFalseConverter}}"/>
                                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" Orientation="Horizontal" Margin="0,5,0,0" Visibility="{Binding SelectedCanvasShoeMasterItem, Converter={StaticResource NullToVisibilityCollapsedConverter}}">
                                    <TextBlock Margin="5,0,15,0" FontWeight="SemiBold"><Run Text="尺码: "/><Run Text="{Binding CanvasShoes_SizeVM, FallbackValue='N/A'}"/></TextBlock>
                                    <TextBlock FontWeight="SemiBold"><Run Text="库存: "/><Run Text="{Binding SelectedCanvasShoeMasterItem.CurrentStock, FallbackValue='N/A'}"/><Run Text=" "/><Run Text="{Binding SelectedCanvasShoeMasterItem.UnitOfMeasure, FallbackValue='双'}"/></TextBlock>
                                </StackPanel>
                            </Grid>
                            <Border Padding="5" BorderBrush="AliceBlue" BorderThickness="1" IsEnabled="{Binding SelectedCanvasShoeMasterItem, Converter={StaticResource NullToBooleanFalseConverter}}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox Grid.Column="0" IsChecked="{Binding CanvasShoes_IsBeingIssued}" VerticalAlignment="Center" Content="发放此规格" Margin="0,0,10,0"/>
                                    <Label Grid.Column="1" Content="新旧*:" IsEnabled="{Binding CanvasShoes_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="2" ItemsSource="{Binding ShoeConditions}" SelectedItem="{Binding CanvasShoes_Condition, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding CanvasShoes_IsBeingIssued}" MinWidth="70" Margin="0,3,10,3" VerticalAlignment="Center" Padding="3"/>
                                    <Label Grid.Column="3" Content="发放日期*:" IsEnabled="{Binding CanvasShoes_IsBeingIssued}" VerticalAlignment="Center"/>
                                    <DatePicker Grid.Column="4" SelectedDate="{Binding CanvasShoes_IssueDate, UpdateSourceTrigger=PropertyChanged, StringFormat=yyyy-MM-dd}" IsEnabled="{Binding CanvasShoes_IsBeingIssued}" MinWidth="100" VerticalAlignment="Center" Padding="3"/>
                                </Grid>
                            </Border>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </Grid>

            <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
                <Button Content="清空表单" Command="{Binding ClearFormCommand}" Padding="10,5" Margin="0,0,10,0"/>
                <Button Content="保存发放记录" Command="{Binding SaveIssuanceCommand}" Padding="10,5" FontWeight="Bold" IsDefault="True"/>
            </StackPanel>
        </Grid>
    </ScrollViewer>
</UserControl>